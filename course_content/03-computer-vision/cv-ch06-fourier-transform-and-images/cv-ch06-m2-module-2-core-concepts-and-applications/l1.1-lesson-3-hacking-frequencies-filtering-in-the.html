<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hacking Frequencies - Filtering in the DCT Domain</title>
<style>
* {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #ffffff;
            min-height: 100vh;
            color: #2d3748;
            line-height: 1.6;
        }

        /* Progress Bar */
        .progress-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: rgba(0, 0, 0, 0.1);
            z-index: 1000;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);
            width: 0%;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(79, 172, 254, 0.5);
        }



        /* Main Container */
        .lesson-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        /* Section Cards */
        section {
            background: transparent;
            margin-bottom: 30px;
            padding: 20px 0;
            display: none;
            opacity: 0;
            transition: all 0.6s ease;
            transform: translateY(20px);
        }

        section.visible {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        /* Typography */
        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.2;
        }

        h2 {
            font-size: 2rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 1rem;
        }

        p {
            font-size: 1.125rem;
            line-height: 1.7;
            color: #4a5568;
            margin-bottom: 1.5rem;
        }

        ul {
            margin-left: 1.5rem;
            margin-bottom: 1.5rem;
        }

        li {
            font-size: 1.125rem;
            line-height: 1.7;
            color: #4a5568;
            margin-bottom: 0.5rem;
        }

        strong {
            color: #2d3748;
            font-weight: 600;
        }

        em {
            color: #667eea;
            font-style: normal;
            font-weight: 500;
        }

        /* Image Placeholders */
        .image-placeholder {
            margin: 2rem 0;
        }

        /* Confetti Animation */
        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
            overflow: hidden;
        }

        .confetti {
            position: absolute;
            font-size: 20px;
            animation: confetti-fall 3s linear infinite;
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        .confetti:nth-child(odd) {
            animation-duration: 2.5s;
            animation-delay: 0.2s;
        }

        .confetti:nth-child(even) {
            animation-duration: 3.5s;
            animation-delay: 0.5s;
        }

        .confetti:nth-child(3n) {
            animation-duration: 2.8s;
            animation-delay: 0.8s;
        }

        .confetti:nth-child(4n) {
            animation-duration: 3.2s;
            animation-delay: 0.3s;
        }

        .confetti:nth-child(5n) {
            animation-duration: 2.7s;
            animation-delay: 0.7s;
        }

        /* Success Message Animation */
        .success-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 20px 30px;
            border-radius: 12px;
            font-size: 1.2em;
            font-weight: 600;
            box-shadow: 0 10px 25px rgba(40, 167, 69, 0.3);
            z-index: 10000;
            opacity: 0;
            animation: success-popup 2.5s ease-out;
            pointer-events: none;
        }

        @keyframes success-popup {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.5);
            }
            20% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.1);
            }
            40% {
                transform: translate(-50%, -50%) scale(1);
            }
            80% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.9);
            }
        }

        .image-placeholder img {
            width: 100%;
            height: auto;
            display: block;
            margin: 0 auto;
        }
        
        /* Specific sizing for individual images by section */
        #section1 .image-placeholder img {
            width: 70% !important;              /* Image 1: 70% (dramatic light beam) */
            max-width: 500px !important;
        }

        #section6 .image-placeholder img {
            width: 55% !important;              /* Image 2: 50-60% (meme image) */
            max-width: 400px !important;
        }
        
        #section9 .image-placeholder img {
            width: 85% !important;              /* Image 3: 80-90% (prism diagram) */
            max-width: 600px !important;
        }
        
        #section13 .image-placeholder img {
            width: 85% !important;              /* Image 4: 80-90% (red object) */
            max-width: 600px !important;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            #section1 .image-placeholder img {
                width: 80% !important;
                max-width: 400px !important;
            }

            #section6 .image-placeholder img {
                width: 65% !important;
                max-width: 350px !important;
            }
            
            #section9 .image-placeholder img,
            #section13 .image-placeholder img {
                width: 90% !important;
                max-width: 450px !important;
            }
        }
        
        @media (max-width: 480px) {
            #section1 .image-placeholder img {
                width: 85% !important;
                max-width: 300px !important;
            }

            #section6 .image-placeholder img {
                width: 75% !important;
                max-width: 280px !important;
            }
            
            #section9 .image-placeholder img,
            #section13 .image-placeholder img {
                width: 95% !important;
                max-width: 320px !important;
            }
        }

        /* Content Boxes */
        .vocab-section, .why-it-matters, .test-your-knowledge, .faq-section, 
        .stop-and-think, .check-your-knowledge {
            margin: 2rem 0;
            padding: 2rem;
            border-radius: 8px;
            border-left: 4px solid;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .vocab-section::before, .why-it-matters::before, .test-your-knowledge::before,
        .faq-section::before, .stop-and-think::before, .check-your-knowledge::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: 0.05;
            z-index: 0;
        }

        .vocab-section {
            background: linear-gradient(135deg, #e6f3ff 0%, #f0f8ff 100%);
            border-left-color: #4facfe;
            box-shadow: 0 10px 30px rgba(79, 172, 254, 0.1);
        }

        .vocab-section::before {
            background: linear-gradient(45deg, #4facfe, #00f2fe);
        }

        .why-it-matters {
            background: linear-gradient(135deg, #ffeef7 0%, #fff0f8 100%);
            border-left-color: #f093fb;
            box-shadow: 0 10px 30px rgba(240, 147, 251, 0.1);
        }

        .why-it-matters::before {
            background: linear-gradient(45deg, #f093fb, #f5576c);
        }

        .test-your-knowledge, .check-your-knowledge {
            background: linear-gradient(135deg, #eafaf1 0%, #f0fcf4 100%);
            border-left-color: #68d391;
            box-shadow: 0 10px 30px rgba(104, 211, 145, 0.1);
        }

        .test-your-knowledge::before, .check-your-knowledge::before {
            background: linear-gradient(45deg, #68d391, #4fd1c7);
        }

        .faq-section {
            background: linear-gradient(135deg, #fffbeb 0%, #fefcf3 100%);
            border-left-color: #fbbf24;
            box-shadow: 0 10px 30px rgba(251, 191, 36, 0.1);
        }

        .faq-section::before {
            background: linear-gradient(45deg, #fbbf24, #f59e0b);
        }

        .stop-and-think {
            background: linear-gradient(135deg, #f3e8ff 0%, #f8f4ff 100%);
            border-left-color: #a78bfa;
            box-shadow: 0 10px 30px rgba(167, 139, 250, 0.1);
        }

        .stop-and-think::before {
            background: linear-gradient(45deg, #a78bfa, #8b5cf6);
        }

        .vocab-section:hover, .why-it-matters:hover, .test-your-knowledge:hover,
        .faq-section:hover, .stop-and-think:hover, .check-your-knowledge:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }

        .vocab-section h3 {
            color: #0ea5e9;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 700;
            margin-bottom: 1rem;
            position: relative;
            z-index: 1;
        }

        .why-it-matters h3 {
            color: #ec4899;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 700;
            margin-bottom: 1rem;
            position: relative;
            z-index: 1;
        }

        .test-your-knowledge h3, .check-your-knowledge h3 {
            color: #10b981;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 700;
            margin-bottom: 1rem;
            position: relative;
            z-index: 1;
        }

        .faq-section h3 {
            color: #d97706;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 700;
            margin-bottom: 1rem;
            position: relative;
            z-index: 1;
        }

        .stop-and-think h3 {
            color: #8b5cf6;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 700;
            margin-bottom: 1rem;
            position: relative;
            z-index: 1;
        }

        .vocab-section h4, .test-your-knowledge h4, .check-your-knowledge h4, .faq-section h4 {
            color: #2d3748;
            font-size: 1.25rem;
            font-weight: 600;
            margin: 1.5rem 0 1rem 0;
            position: relative;
            z-index: 1;
        }

        .vocab-term {
            color: #0ea5e9;
            font-weight: 600;
        }

        /* Buttons */
        .continue-button, .reveal-button, .check-button {
            display: inline-block;
            padding: 16px 32px;
            margin-top: 2rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50px;
            text-decoration: none;
            cursor: pointer;
            border: none;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
            position: relative;
            overflow: hidden;
        }

        .continue-button::before, .reveal-button::before, .check-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .continue-button:hover, .reveal-button:hover, .check-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
        }

        .continue-button:hover::before, .reveal-button:hover::before, .check-button:hover::before {
            left: 100%;
        }

        .continue-button:active, .reveal-button:active, .check-button:active {
            transform: translateY(-1px);
        }

        /* Hidden state for conditional buttons */
        .continue-button[style*="display: none"] {
            display: none !important;
        }

        /* Ensure all conditional continue buttons match normal button styling exactly when shown */
        #continue-after-interactive:not([style*="display: none"]),
        #continue-after-check-knowledge:not([style*="display: none"]),
        #continue-after-test-knowledge:not([style*="display: none"]) {
            display: inline-block !important;
            width: auto !important;
            max-width: none !important;
            min-width: auto !important;
            padding: 16px 32px !important;
            margin: 30px auto !important;
            box-sizing: border-box !important;
        }

        /* Center ALL continue buttons by making all sections center them */
        section {
            text-align: center;
        }

        /* Reset text alignment for all content except continue buttons */
        section > *:not(.continue-button) {
            text-align: left;
        }

        /* Ensure content boxes also have left alignment */
        .check-your-knowledge,
        .test-your-knowledge,
        .vocab-section,
        .why-it-matters,
        .faq-section,
        .stop-and-think {
            text-align: left;
        }

        /* Smooth appearance for conditional continue buttons */
        .continue-button.show-with-animation {
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.6s ease-out forwards;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Multiple Choice */
        .multiple-choice {
            margin: 1.5rem 0;
        }

        .choice-option {
            display: block;
            margin: 1rem 0;
            padding: 1.5rem;
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        .choice-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 0;
        }

        .choice-option:hover {
            transform: translateX(5px);
            border-color: rgba(102, 126, 234, 0.3);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.15);
        }

        .choice-option:hover::before {
            opacity: 0.05;
        }

        .choice-option.selected, .choice-option.correct {
            background: linear-gradient(135deg, #eafaf1 0%, #f0fcf4 100%);
            border-color: #68d391;
            color: #2d3748;
        }

        .choice-option.incorrect {
            background: linear-gradient(135deg, #fef2f2 0%, #fef7f7 100%);
            border-color: #f87171;
            color: #2d3748;
        }

        .choice-explanation {
            display: none;
            margin-top: 1rem;
            padding: 1rem;
            background: #f1f5f9;
            border-radius: 8px;
            font-size: 0.9rem;
            line-height: 1.6;
            animation: fadeIn 0.5s ease;
            position: relative;
            z-index: 1;
        }

        /* Spectrum Explorer - keeping the interactive styles but updating colors */
        .spectrum-explorer {
            position: relative;
            width: 100%;
            max-width: 100%;
            margin: 2rem 0;
            background: #ffffff;
            border: 1px solid #e2e8f0;
            padding: 40px;
        }

        .stage {
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .stage-text h3 {
            font-size: 1.75rem;
            font-weight: 600;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 0 0 16px 0;
        }

        .instruction {
            font-size: 1.1rem;
            color: #6b7280;
            margin: 0;
            padding: 16px 24px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 12px;
            border: 2px dashed rgba(102, 126, 234, 0.3);
        }

        .continue-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 16px 32px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .continue-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
        }

        .revelation-text h3 {
            font-size: 2rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 0 0 16px 0;
        }

        .spectrum-point {
            border-radius: 16px;
            transition: all 0.3s ease;
            border: 2px solid #e2e8f0;
            background: #ffffff;
        }

        .spectrum-point:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.2);
            border-color: rgba(102, 126, 234, 0.3);
        }

        .spectrum-point.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
        }

        .info-panel {
            background: #ffffff;
            border-radius: 16px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            padding: 24px;
        }

        .region-title {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hook {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .lesson-container {
                padding: 20px 15px;
            }

            section {
                padding: 15px 0;
                margin-bottom: 20px;
            }

            h1 {
                font-size: 2rem;
            }

            h2 {
                font-size: 1.75rem;
            }

            p, li {
                font-size: 1rem;
            }



            .continue-button, .reveal-button, .check-button {
                width: 100%;
            text-align: center;
                margin-top: 1.5rem;
            }

            .spectrum-explorer {
                padding: 20px;
            }

            .choice-option {
                padding: 1rem;
            }

            .mark-completed-button {
                padding: 14px 28px;
                font-size: 0.9rem;
                margin: 30px auto 15px auto;
            }
        }

        @media (max-width: 480px) {
            .lesson-container {
                padding: 15px 10px;
            }

            section {
                padding: 10px 0;
            }

            h1 {
                font-size: 1.75rem;
            }

            .vocab-section, .why-it-matters, .test-your-knowledge, 
            .faq-section, .stop-and-think, .check-your-knowledge {
                padding: 1.5rem;
            }

            .mark-completed-button {
                padding: 12px 24px;
                font-size: 0.85rem;
                margin: 25px auto 10px auto;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-in {
            animation: fadeIn 0.5s ease-out;
        }

        /* Accessibility */
        .choice-option:focus {
            outline: 2px solid #667eea;
            outline-offset: 2px;
        }

        .continue-button:focus, .reveal-button:focus, .check-button:focus {
            outline: 2px solid white;
            outline-offset: 2px;
        }

        /* Content positioning */
        .vocab-section *, .why-it-matters *, .test-your-knowledge *, 
        .faq-section *, .stop-and-think *, .check-your-knowledge * {
            position: relative;
            z-index: 1;
        }

        /* Mark as Completed Button */
        .mark-completed-button {
            display: none;
            width: 100%;
            max-width: 400px;
            margin: 40px auto 20px auto;
            padding: 16px 32px;
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(72, 187, 120, 0.3);
            text-align: center;
            text-decoration: none;
        }

        .mark-completed-button.show {
            display: block;
        }

        .mark-completed-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(72, 187, 120, 0.4);
            background: linear-gradient(135deg, #38a169 0%, #2f855a 100%);
        }

        .mark-completed-button:active {
            transform: translateY(0);
        }

        .mark-completed-button.completed {
            background: linear-gradient(135deg, #94a3b8 0%, #64748b 100%);
            box-shadow: 0 4px 20px rgba(148, 163, 184, 0.3);
            cursor: default;
        }

        .mark-completed-button.completed:hover {
            background: linear-gradient(135deg, #94a3b8 0%, #64748b 100%);
            box-shadow: 0 4px 20px rgba(148, 163, 184, 0.3);
            transform: none;
        }

        /* Success Message */
        .lesson-success-message {
            text-align: center;
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 600;
            margin: 20px auto;
            max-width: 300px;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
        }

        .lesson-success-message.show {
            opacity: 1;
            transform: translateY(0);
        }



        /* Spectrum Explorer specific modern styles */
        .spectrum-explorer {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
        }

        .prism-svg {
            cursor: pointer;
            user-select: none;
            margin-bottom: 24px;
            filter: drop-shadow(0 10px 30px rgba(0,0,0,0.1));
            border-radius: 12px;
        }

        .visible-indicator {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 2px solid #667eea;
            color: #667eea;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
        }

        .scale-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.875rem;
            color: #6b7280;
            font-weight: 500;
        }

        .scale-label.visible {
            color: #667eea;
            font-weight: 600;
        }

        .exploration-progress {
            text-align: center;
            margin-top: 20px;
            padding: 16px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }

        .progress-text {
            font-size: 0.875rem;
            color: #667eea;
            font-weight: 600;
        }



        /* Keep all other spectrum explorer functionality styles */
        .spectrum-bar {
            position: relative;
            width: 100%;
            height: 60px;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        #spectrum-canvas {
            width: 100%;
            height: 100%;
            border-radius: 12px;
        }

        .spectrum-points {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 0 0 24px 0;
            gap: 8px;
        }

        .spectrum-point {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            padding: 12px 8px;
            cursor: pointer;
            min-width: 80px;
            outline: none;
        }

        .point-icon {
            font-size: 1.5rem;
        }
        
        .point-label {
            font-size: 0.75rem;
            font-weight: 600;
            text-align: center;
        }

        .energy-scale {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 16px;
        }

        .energy-label {
            font-size: 0.875rem;
            color: #6b7280;
            white-space: nowrap;
            font-weight: 500;
        }

        .energy-bar {
            flex: 1;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
        }

        .energy-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981 0%, #f59e0b 50%, #ef4444 100%);
            transition: width 0.5s ease;
            border-radius: 4px;
        }

        .panel-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 20px;
        }
        
        .panel-header .region-icon {
            color: initial !important;
            background: none !important;
            -webkit-text-fill-color: initial !important;
            background-clip: initial !important;
        }
        
        /* Fix emoji colors in revelation text and all spectrum content */
        .revelation-text h3,
        .revelation-text,
        .spectrum-point .point-icon,
        h3 {
            color: inherit;
        }
        
        /* Target emojis specifically to prevent color inheritance */
        .revelation-text h3::after,
        .revelation-text h3 *,
        .spectrum-point .point-icon,
        .point-icon {
            background: none !important;
            -webkit-background-clip: initial !important;
            -webkit-text-fill-color: initial !important;
            background-clip: initial !important;
            color: initial !important;
            font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif !important;
        }
        
        /* Specific fix for Mind = Blown emoji */
        .revelation-text h3 {
            background: none !important;
            -webkit-background-clip: initial !important;
            -webkit-text-fill-color: initial !important;
            background-clip: initial !important;
        }
        
        /* Universal emoji fix */
        span[style*="color: initial"],
        .emoji-fix {
            font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", "Segoe UI Symbol", sans-serif !important;
            font-style: normal !important;
            font-variant: normal !important;
            text-rendering: auto !important;
            -webkit-font-smoothing: auto !important;
        }
        
        /* Additional emoji protection */
        .revelation-text span,
        .spectrum-point .point-icon {
            display: inline !important;
            text-decoration: none !important;
            font-weight: normal !important;
        }

        .region-icon {
            font-size: 2rem;
            color: initial;
            text-shadow: none;
            filter: none;
            display: inline-block;
            font-family: "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif;
        }

        .story-content {
            margin-bottom: 24px;
        }

        .description {
            font-size: 1rem;
            line-height: 1.6;
            margin: 0;
            color: #6b7280;
        }

        .tech-specs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }

        .spec-item {
            text-align: center;
            padding: 12px;
            background: rgba(102, 126, 234, 0.05);
            border-radius: 12px;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .spec-label {
            display: block;
            font-size: 0.75rem;
            color: #6b7280;
            text-transform: uppercase;
            font-weight: 600;
            margin-bottom: 4px;
            letter-spacing: 0.05em;
        }

        .spec-value {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            color: #374151;
        }

        .color-display {
            margin-top: 16px;
        }

        .color-swatch {
            height: 40px;
            border-radius: 12px;
            margin-bottom: 8px;
            border: 2px solid rgba(102, 126, 234, 0.2);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .color-note {
            font-size: 0.875rem;
            color: #6b7280;
            margin: 0;
            font-style: italic;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Responsive design for spectrum explorer */
        @media (min-width: 768px) {
            .exploration-container {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 32px;
                align-items: start;
            }
            
            .spectrum-points {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .spectrum-point {
                min-width: 100px;
            }
        }

        @media (max-width: 480px) {
            .spectrum-explorer {
                padding: 20px;
            }
            
            .spectrum-points {
                display: grid;
                grid-template-columns: repeat(4, 1fr);
                gap: 12px;
            }
            
            .spectrum-point {
                min-width: auto;
            }
            
            .point-label {
                font-size: 0.7rem;
            }
            
            .tech-specs {
                grid-template-columns: 1fr;
            }
        }

        /* Section 5: High-Pass Visual Aid */
        .highpass .hp-grid {
            display: grid;
            grid-template-columns: 1fr 40px 1fr 40px 1fr;
            gap: 12px;
            align-items: center;
        }
        .highpass .hp-canvas {
            position: relative;
            height: 140px;
            border: 1px solid #e2e8f0;
            border-radius: 10px;
            overflow: hidden;
            background: #f8fafc;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .highpass .hp-photo {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }
        .highpass .hp-arrow svg { width: 32px; height: 32px; overflow: visible; }
        .highpass .hp-arrow path { stroke: #667eea; stroke-width: 2; fill: none; stroke-linecap: round; stroke-linejoin: round; }
        .highpass .hp-dct {
            background:
                radial-gradient(circle at 0% 0%, rgba(255,255,255,0.85) 0%, rgba(255,255,255,0.6) 10%, rgba(102,126,234,0.45) 24%, rgba(118,75,162,0.25) 40%, rgba(15,23,42,0.08) 60%, rgba(15,23,42,0.02) 100%),
                #111827;
        }
        .highpass .hp-block {
            position: absolute;
            top: 0;
            left: 0;
            width: 120px;
            height: 120px;
            background: #0b0f19; /* blacked-out low-freqs */
            border-bottom-right-radius: 120px; /* quarter circle */
            box-shadow: 0 0 0 2px #0b0f19 inset;
            pointer-events: none;
        }
        .highpass .hp-result-photo {
            filter: grayscale(1) contrast(1.25) brightness(1.05);
        }
        #section5.visible .highpass .hp-grid > * { opacity: 0; transform: translateY(8px); animation: fadeInUp 0.5s ease-out forwards; }
        #section5.visible .highpass .hp-grid > *:nth-child(1){animation-delay:0s}
        #section5.visible .highpass .hp-grid > *:nth-child(2){animation-delay:.05s}
        #section5.visible .highpass .hp-grid > *:nth-child(3){animation-delay:.1s}
        #section5.visible .highpass .hp-grid > *:nth-child(4){animation-delay:.15s}
        #section5.visible .highpass .hp-grid > *:nth-child(5){animation-delay:.2s}
        @media (max-width: 768px) {
            .highpass .hp-grid { grid-template-columns: 1fr; }
            .highpass .hp-arrow { transform: rotate(90deg); }
        }

        /* Section 4: Low-Pass Visual Aid */
        .lowpass .lp-grid {
            display: grid;
            grid-template-columns: 1fr 40px 1fr 40px 1fr;
            gap: 12px;
            align-items: center;
        }
        .lowpass .lp-canvas {
            position: relative;
            height: 140px;
            border: 1px solid #e2e8f0;
            border-radius: 10px;
            overflow: hidden;
            background: #f8fafc;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .lowpass .lp-photo {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }
        .lowpass .lp-arrow svg { width: 32px; height: 32px; overflow: visible; }
        .lowpass .lp-arrow path { stroke: #667eea; stroke-width: 2; fill: none; stroke-linecap: round; stroke-linejoin: round; }
        .lowpass .lp-dct {
            background:
                radial-gradient(circle at 0% 0%, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.6) 10%, rgba(102,126,234,0.45) 25%, rgba(118,75,162,0.25) 40%, rgba(15,23,42,0.08) 60%, rgba(15,23,42,0.02) 100%),
                #111827;
        }
        .lowpass .lp-mask {
            position: absolute;
            top: 10px;
            left: 10px;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 3px solid #667eea;
            box-shadow: 0 0 0 9999px rgba(0,0,0,0.28);
            pointer-events: none;
        }
        .lowpass .lp-cross::before,
        .lowpass .lp-cross::after {
            content: '';
            position: absolute;
            right: 8px;
            bottom: 8px;
            width: 2px;
            height: 56px;
            background: #ef4444;
        }
        .lowpass .lp-cross::before { transform: translate(-8px,-8px) rotate(45deg); }
        .lowpass .lp-cross::after { transform: translate(-8px,-8px) rotate(-45deg); }
        .lowpass .lp-result-photo { filter: blur(2px) contrast(0.95) saturate(0.95); }
        #section4.visible .lowpass .lp-grid > * { opacity: 0; transform: translateY(8px); animation: fadeInUp 0.5s ease-out forwards; }
        #section4.visible .lowpass .lp-grid > *:nth-child(1){animation-delay:0s}
        #section4.visible .lowpass .lp-grid > *:nth-child(2){animation-delay:.05s}
        #section4.visible .lowpass .lp-grid > *:nth-child(3){animation-delay:.1s}
        #section4.visible .lowpass .lp-grid > *:nth-child(4){animation-delay:.15s}
        #section4.visible .lowpass .lp-grid > *:nth-child(5){animation-delay:.2s}
        @media (max-width: 768px) {
            .lowpass .lp-grid { grid-template-columns: 1fr; }
            .lowpass .lp-arrow { transform: rotate(90deg); }
        }

        /* Visual Aid (Section 2) */
        .visual-aid {
            margin: 1.5rem 0 0 0;
        }
        .visual-aid figcaption {
            font-size: 0.875rem;
            font-weight: 700;
            color: #667eea;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 1rem;
        }
        .va-grid {
            display: grid;
            grid-template-columns: 1fr 40px 1fr 40px 1fr 40px 1fr;
            align-items: center;
            gap: 12px;
        }
        .va-panel {
            background: #ffffff;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.06);
        }
        .va-title {
            font-size: 0.95rem;
            font-weight: 600;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 0 0 8px 0;
        }
        .va-canvas {
            position: relative;
            height: 140px;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
            overflow: hidden;
            background: #f8fafc;
        }
        .va-photo {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }
        .va-desc {
            font-size: 0.9rem;
            color: #6b7280;
            margin: 8px 0 0 0;
        }
        .va-arrow {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .va-arrow svg {
            width: 32px;
            height: 32px;
            overflow: visible;
        }
        .va-arrow path {
            stroke: #667eea;
            stroke-width: 2;
            fill: none;
            stroke-linecap: round;
            stroke-linejoin: round;
        }
        /* Spatial (placeholder) */
        .va-spatial {
            background:
                linear-gradient(135deg, rgba(102,126,234,0.12), rgba(118,75,162,0.08)),
                repeating-linear-gradient(45deg, #e5e7eb 0, #e5e7eb 10px, #f3f4f6 10px, #f3f4f6 20px);
        }
        /* DCT heatmap (placeholder) */
        .va-dct {
            background:
                radial-gradient(circle at 0% 0%, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.6) 10%, rgba(102,126,234,0.45) 25%, rgba(118,75,162,0.25) 40%, rgba(15,23,42,0.08) 60%, rgba(15,23,42,0.02) 100%),
                #111827;
        }
        /* Modify: keep lows, zero highs */
        .va-modify {
            background:
                radial-gradient(circle at 0% 0%, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.6) 10%, rgba(102,126,234,0.45) 25%, rgba(118,75,162,0.25) 40%, rgba(15,23,42,0.08) 60%, rgba(15,23,42,0.02) 100%),
                #111827;
        }
        .va-mask {
            position: absolute;
            top: 10px;
            left: 10px;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 3px solid #667eea;
            box-shadow: 0 0 0 9999px rgba(0,0,0,0.25);
            pointer-events: none;
        }
        .va-cross {
            position: absolute;
            right: 8px;
            bottom: 8px;
            width: 56px;
            height: 56px;
            pointer-events: none;
        }
        .va-cross::before,
        .va-cross::after {
            content: '';
            position: absolute;
            left: 50%;
            top: 50%;
            width: 2px;
            height: 56px;
            background: #ef4444;
            transform-origin: center;
            border-radius: 2px;
        }
        .va-cross::before { transform: translate(-50%,-50%) rotate(45deg); }
        .va-cross::after { transform: translate(-50%,-50%) rotate(-45deg); }
        /* Result (placeholder blur) */
        .va-result {
            background:
                linear-gradient(135deg, rgba(102,126,234,0.08), rgba(118,75,162,0.06)),
                repeating-linear-gradient(0deg, #e5e7eb 0, #e5e7eb 6px, #f3f4f6 6px, #f3f4f6 12px);
            filter: blur(0.3px) saturate(0.95);
        }
        .va-result-photo {
            filter: blur(2px) contrast(0.95) saturate(0.95);
        }
        /* Animation: trigger when section becomes visible */
        .va-grid > * {
            opacity: 0;
            transform: translateY(8px);
        }
        #section2.visible .va-grid > * {
            animation: fadeInUp 0.5s ease-out forwards;
        }
        #section2.visible .va-grid > *:nth-child(1) { animation-delay: 0s; }
        #section2.visible .va-grid > *:nth-child(2) { animation-delay: 0.05s; }
        #section2.visible .va-grid > *:nth-child(3) { animation-delay: 0.1s; }
        #section2.visible .va-grid > *:nth-child(4) { animation-delay: 0.15s; }
        #section2.visible .va-grid > *:nth-child(5) { animation-delay: 0.2s; }
        #section2.visible .va-grid > *:nth-child(6) { animation-delay: 0.25s; }
        #section2.visible .va-grid > *:nth-child(7) { animation-delay: 0.3s; }
        /* Mobile */
        @media (max-width: 768px) {
            .va-grid {
                grid-template-columns: 1fr;
            }
            .va-arrow {
                transform: rotate(90deg);
            }
        }

        /* Section 6: Frequency Filter Playground */
        .filter-playground {
            background: #ffffff;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.06);
            padding: 16px;
            margin: 16px 0;
        }
        .fp-panels {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            gap: 16px;
            align-items: start;
        }
        .fp-panel {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 10px;
            padding: 12px;
            position: relative;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .fp-panel canvas {
            width: 128px;
            height: 128px;
            display: block;
            margin: 0 auto;
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
        }
        .fp-controls {
            margin-top: 16px;
            display: grid;
            grid-template-columns: 1fr 1fr auto;
            gap: 16px;
            align-items: center;
        }
        .fp-control {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 10px;
            padding: 12px;
        }
        .fp-control label { font-size: 0.95rem; font-weight: 600; color: #374151; display: block; margin-bottom: 6px; }
        .fp-control input[type="range"] { width: 100%; }
        .fp-val { color: #667eea; font-weight: 700; }
        .fp-actions { display: flex; gap: 12px; align-items: center; justify-content: flex-end; }
        .fp-note { font-size: 0.875rem; color: #6b7280; }
        @media (max-width: 768px){
            .fp-panels { grid-template-columns: 1fr; }
            .fp-controls { grid-template-columns: 1fr; }
            .fp-actions { justify-content: flex-start; }
        }
</style>
</head>
<body>
<div class="progress-container"><div class="progress-bar" id="progressBar"></div></div>
<div class="lesson-container">

<section id="section1" class="visible">
    <div class="image-placeholder">
    <img src="images/l62_1.png" alt="A stylized image of a prism, but instead of light passing through and splitting into a rainbow, a small 8x8 image block passes through and splits into the 64 DCT basis functions. This visually represents the DCT's function of decomposition.">
</div>
<h1>Hacking Frequencies: Filtering in the DCT Domain</h1>
<h2>The Frequency Equalizer</h2>

<p>Welcome to the fun part! Now that we know how to use the DCT to split an image into its frequency components, we can start messing with them. Think of it like being a DJ with a sound equalizer for your pictures. Want more bass? Boost the low frequencies. Want more treble? Boost the highs. We can do the exact same thing with images to achieve some incredible effects.</p>
<button class="continue-button" onclick="showNextSection(2)">Continue</button>
</section>

<section id="section2">
<h2>The Three-Step Filtering Process</h2>
<p>Filtering in the frequency domain always follows the same simple, three-step recipe. It's a fundamental workflow you'll see again and again.</p>
<figure class="visual-aid" aria-labelledby="va-caption">
<figcaption id="va-caption">Three-step frequency filtering workflow</figcaption>
<div class="va-grid">
<div class="va-panel">
<div class="va-title">Start (Spatial Domain)</div>
<div class="va-canvas va-spatial" role="img" aria-label="Original cat image (spatial domain)">
<img class="va-photo" src="assets/lesson3/cat.jpg" alt="Original cat image" loading="lazy" decoding="async" onerror="this.style.display='none'">
</div>
<p class="va-desc">Pixels and intensities.</p>
</div>
<div class="va-arrow" aria-hidden="true">
<svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M2 16H26M20 10L26 16L20 22"></path></svg>
</div>
<div class="va-panel">
<div class="va-title">Step 1: DCT</div>
<div class="va-canvas va-dct" role="img" aria-label="DCT magnitude heatmap with bright low-frequency corner"></div>
<p class="va-desc">Convert to frequencies; energy clusters top-left.</p>
</div>
<div class="va-arrow" aria-hidden="true">
<svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M2 16H26M20 10L26 16L20 22"></path></svg>
</div>
<div class="va-panel">
<div class="va-title">Step 2: Modify</div>
<div class="va-canvas va-modify" role="img" aria-label="DCT with low-frequency keep-mask; high frequencies crossed out"><div class="va-mask"></div><div class="va-cross"></div></div>
<p class="va-desc">Keep lows, zero highs → low-pass mask.</p>
</div>
<div class="va-arrow" aria-hidden="true">
<svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M2 16H26M20 10L26 16L20 22"></path></svg>
</div>
<div class="va-panel">
<div class="va-title">Step 3: Inverse DCT</div>
<div class="va-canvas va-result" role="img" aria-label="Reconstructed image (blurred) after inverse DCT">
<img class="va-photo va-result-photo" src="assets/lesson3/cat.jpg" alt="Reconstructed image (blurred)" loading="lazy" decoding="async" onerror="this.style.display='none'">
</div>
<p class="va-desc">Back to pixels → blur emerges.</p>
</div>
</div>
</figure>
<p>That's it! <strong>Transform -> Modify -> Inverse Transform.</strong> By controlling what we do in that middle step, we can create all sorts of filters.</p>
<button class="continue-button" onclick="showNextSection(3)">Continue</button>
</section>

<section id="section3">
<h2>Low-Pass Filtering: The Blurring Effect</h2>
<p>Let's start with a classic: a <strong>low-pass filter</strong>. The name says it all—it lets the <em>low frequencies pass</em> through while blocking, or attenuating, the high frequencies. What do you think happens when we remove the high frequencies from an image?</p>
<div class="check-your-knowledge">
<h3>Check Your Understanding</h3>
<p>Remember what high frequencies represent in an image. If we get rid of them, what visual information do we lose?</p>
<div id="cya1" style="display:none" class="animate-in"><p>We lose the sharp details! High frequencies correspond to edges, textures, and fine lines. Removing them should make the image smoother or blurrier.</p></div>
<button class="reveal-button" onclick="revealAnswer('cya1')">Reveal Answer</button>
</div>
<button class="continue-button" onclick="showNextSection(4)">Continue</button>
</section>

<section id="section4">
<p>You got it! Removing high-frequency information is the very definition of blurring. In the DCT domain, this is super easy. We just take our DCT coefficients and set all the high-frequency ones—those far away from the top-left corner—to zero.</p>
<figure class="visual-aid lowpass" aria-labelledby="lp-caption">
<figcaption id="lp-caption">Low‑Pass Filtering (keep lows, zero highs)</figcaption>
<div class="lp-grid">
<div class="va-panel">
<div class="va-title">Original Image</div>
<div class="lp-canvas lp-spatial" role="img" aria-label="Original image"><canvas id="lp-static-original" width="128" height="128" aria-label="Low-pass original"></canvas></div>
<p class="va-desc">Spatial domain (pixels).</p>
</div>
<div class="lp-arrow" aria-hidden="true">
<svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M2 16H26M20 10L26 16L20 22"></path></svg>
</div>
<div class="va-panel">
<div class="va-title">DCT + Low‑Pass Mask</div>
<div class="lp-canvas lp-dct" role="img" aria-label="DCT magnitude with circular keep mask near top-left"><canvas id="lp-static-dct" width="128" height="128" aria-label="Low-pass DCT canvas"></canvas></div>
<p class="va-desc">Keep low frequencies (bright corner), zero out the rest.</p>
</div>
<div class="lp-arrow" aria-hidden="true">
<svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M2 16H26M20 10L26 16L20 22"></path></svg>
</div>
<div class="va-panel">
<div class="va-title">Inverse DCT (Result)</div>
<div class="lp-canvas lp-result" role="img" aria-label="Blurred result after low‑pass"><canvas id="lp-static-result" width="128" height="128" aria-label="Low-pass result"></canvas></div>
<p class="va-desc">Smoother image (edges/details suppressed).</p>
</div>
</div>
</figure>
<button class="continue-button" onclick="showNextSection(5)">Continue</button>
</section>

<section id="section5">
<h2>High-Pass Filtering: Finding the Edges</h2>
<p>Okay, so if removing high frequencies causes blurring, what happens if we do the opposite? A <strong>high-pass filter</strong> blocks the low frequencies and lets the <em>high frequencies pass</em> through.</p>
<p>This means we'll set the coefficients in the top-left corner—including the all-important DC component—to zero, and keep everything else. This effectively subtracts the 'smooth' parts of the image.</p>
<figure class="visual-aid highpass" aria-labelledby="hp-caption">
<figcaption id="hp-caption">High‑Pass Filtering (remove lows, keep highs)</figcaption>
<div class="hp-grid">
<div class="va-panel">
<div class="va-title">Original Image</div>
<div class="hp-canvas hp-spatial" role="img" aria-label="Original image"><canvas id="hp-static-original" width="128" height="128" aria-label="High-pass original"></canvas></div>
<p class="va-desc">Spatial domain (pixels).</p>
</div>
<div class="hp-arrow" aria-hidden="true">
<svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M2 16H26M20 10L26 16L20 22"></path></svg>
</div>
<div class="va-panel">
<div class="va-title">DCT + High‑Pass Mask</div>
<div class="hp-canvas hp-dct" role="img" aria-label="DCT magnitude with low‑frequency region removed"><canvas id="hp-static-dct" width="128" height="128" aria-label="High-pass DCT canvas"></canvas></div>
<p class="va-desc">Zero out low frequencies (top‑left corner), keep the rest.</p>
</div>
<div class="hp-arrow" aria-hidden="true">
<svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M2 16H26M20 10L26 16L20 22"></path></svg>
</div>
<div class="va-panel">
<div class="va-title">Inverse DCT (Result)</div>
<div class="hp-canvas hp-result" role="img" aria-label="Edge‑like result after high‑pass"><canvas id="hp-static-result" width="128" height="128" aria-label="High-pass result"></canvas></div>
<p class="va-desc">Edges/details emphasized (smooth parts removed).</p>
</div>
</div>
</figure>
<p>The result is a form of edge detection! We're left with only the sharp details and textures. While there are other, more common ways to detect edges (which we'll see later!), this perfectly demonstrates what kind of information is stored in which frequencies.</p>
<button class="continue-button" onclick="showNextSection(6)">Continue</button>
</section>

<section id="section6">
<h2>The Interactive Filter Playground</h2>
<p>Now it's your turn to be the frequency DJ. Use the sliders below to see the effects of low-pass and high-pass filtering in real-time.</p>
<div class="filter-playground" id="filterPlayground">
<div class="fp-panels">
<div class="fp-panel"><div class="va-title">Original</div><canvas id="fp-original" width="256" height="256" aria-label="Original image canvas"></canvas></div>
<div class="fp-panel"><div class="va-title">Low‑Pass Mask</div><canvas id="fp-dct-lp" width="256" height="256" aria-label="DCT with low‑pass mask"></canvas></div>
<div class="fp-panel"><div class="va-title">High‑Pass Mask</div><canvas id="fp-dct-hp" width="256" height="256" aria-label="DCT with high‑pass mask"></canvas></div>
<div class="fp-panel"><div class="va-title">Combined Result</div><canvas id="fp-processed" width="256" height="256" aria-label="Processed image canvas"></canvas></div>
</div>
<div class="fp-controls">
<div class="fp-control"><label for="fp-low">Low‑Pass Filter (keep up to): <span class="fp-val" id="fp-low-val">100%</span></label><input id="fp-low" type="range" min="1" max="100" value="100" step="1" aria-label="Low‑Pass keep percent"></div>
<div class="fp-control"><label for="fp-high">High‑Pass Filter (keep from): <span class="fp-val" id="fp-high-val">0%</span></label><input id="fp-high" type="range" min="0" max="99" value="0" step="1" aria-label="High‑Pass keep from percent"></div>
<div class="fp-actions"><button class="continue-button" type="button" id="fp-reset">Reset</button></div>
</div>
<p class="fp-note" id="fp-status" aria-live="polite">Combined: Low‑Pass + High‑Pass • Size: 128×128</p>
</div>
<p>Play around with the sliders. Notice how a tiny bit of low-pass filtering can subtly soften an image, while extreme filtering removes all detail. See how high-pass filtering can isolate the most detailed parts of the scene.</p>
<div class="why-it-matters"><h3>Why It Matters</h3><p>Why does this matter? Filtering in the frequency domain gives us a powerful, intuitive way to manipulate the fundamental characteristics of an image. And while we might use other methods for simple blurring, understanding this concept is <em>crucial</em> for grasping how JPEG works—because, as we'll soon see, compression is essentially a very clever and aggressive form of frequency filtering!</p></div>
<button class="continue-button" onclick="showNextSection(7)">Continue</button>
</section>

<section id="section7">
<h2>A Note on Denoising</h2>
<p>As a quick bonus, this same principle can be used for a simple form of denoising. Random noise in an image often shows up as small, sprinkled contributions across many of the high-frequency coefficients.</p>
<div class="visual-aid-placeholder"><strong>Visual Aid</strong> — placeholder: Based on Figure 6.6. A three-panel diagram. Left: A photo with visible static-like noise. Middle: Its DCT representation, showing the usual bright low-frequency corner but also a faint 'spray' of dots across the high-frequency areas. Right: The denoised photo, which is cleaner but slightly softer, after thresholding the DCT coefficients.</div>
<p>A simple strategy is to transform the noisy image, set all coefficients below a certain magnitude threshold to zero (assuming they're just noise), and transform back. It's a blunt instrument—it can also remove fine details—but it shows the power of separating signal from noise in the frequency domain.</p>
<div class="multiple-choice">
<h3>Test Your Knowledge</h3>
<p>To perform edge detection on an image using the DCT, what would you do to the coefficients before applying the Inverse DCT?</p>
<div class="choice-option" onclick="selectChoice(this,false,'Set all coefficients to zero.','If you set all coefficients to zero, the inverse transform will just be a black image! You need to keep some of them.')">Set all coefficients to zero.</div>
<div class="choice-option" onclick="selectChoice(this,false,'Set the high-frequency coefficients to zero.','This is the process for a low-pass filter, which results in blurring, not edge detection.')">Set the high-frequency coefficients to zero.</div>
<div class="choice-option" onclick="selectChoice(this,true,'Set the low-frequency coefficients (including the DC component) to zero.','Correct! Edge information is stored in the high frequencies. By removing the low frequencies (the smooth parts), you are left with only the edges.')">Set the low-frequency coefficients (including the DC component) to zero.</div>
<div class="choice-option" onclick="selectChoice(this,false,'Double the value of all coefficients.','Doubling all the coefficients would just make the resulting image twice as bright, but it wouldn\'t selectively filter for edges.')">Double the value of all coefficients.</div>
</div>
<button class="continue-button" id="continue-after-test-knowledge" onclick="showNextSection(8)" style="display:none">Continue</button>
</section>

<section id="section8">
<h2>Review and Reflect</h2>
<p>Let's recap our filtering experiments.</p>
<p>In this lesson, we learned how to manipulate images by filtering in the frequency domain. The key takeaways are:</p>
<ul>
<li>The process is always <strong>Transform -> Modify -> Inverse Transform</strong>.</li>
<li>A <strong>Low-Pass Filter</strong> removes high frequencies, resulting in a <strong>blurring</strong> effect.</li>
<li>A <strong>High-Pass Filter</strong> removes low frequencies, resulting in an <strong>edge detection</strong> effect.</li>
</ul>
<p>We've now seen the theory and a powerful application of the DCT. Next up, we'll see how these exact principles are put to work in the most significant application of all: the JPEG compression standard that powers the web.</p>
</section>

<button id="markCompletedBtn" class="mark-completed-button" onclick="toggleCompleted()">✓ Mark as Completed</button>

</div>

<script>
let currentSection=1;const totalSections=8;updateProgress();if(currentSection===totalSections){const b=document.getElementById('markCompletedBtn');if(b){b.classList.add('show')}}
function showNextSection(nextId){const next=document.getElementById('section'+nextId);const btn=event&&event.target;if(!next)return;if(btn)btn.style.display='none';next.classList.add('visible','animate-in');currentSection=nextId;updateProgress();if(currentSection===totalSections){const b=document.getElementById('markCompletedBtn');if(b){b.classList.add('show')}}setTimeout(()=>{next.scrollIntoView({behavior:'smooth',block:'start'})},200)}
function updateProgress(){const bar=document.getElementById('progressBar');const pct=(currentSection/totalSections)*100;bar.style.width=pct+'%'}
function revealAnswer(id){const el=document.getElementById(id);const btn=event&&event.target;if(el){el.style.display='block';el.classList.add('animate-in')}if(btn)btn.style.display='none'}
function selectChoice(element,isCorrect,optionText,explanation){const group=element.parentNode.querySelectorAll('.choice-option');group.forEach(c=>{c.classList.remove('selected','correct','incorrect');const old=c.querySelector('.choice-explanation');if(old)old.remove()});element.classList.add('selected');element.classList.add(isCorrect?'correct':'incorrect');const ex=document.createElement('div');ex.className='choice-explanation animate-in';ex.style.display='block';ex.innerHTML='<strong>'+(isCorrect?'Correct!':'Not quite.')+'</strong> '+explanation;element.appendChild(ex);const cont=document.getElementById('continue-after-test-knowledge');if(cont&&cont.style.display==='none'){setTimeout(()=>{cont.style.display='inline-block'},600)}}
document.addEventListener('keydown',function(e){if(e.key==='ArrowRight'||e.key===' '){const btn=document.querySelector('#section'+currentSection+' .continue-button');if(btn&&btn.style.display!=='none'){e.preventDefault();btn.click()}}});
// Section 6: Frequency Filter Playground (DCT/IDCT)
(()=>{const section=document.getElementById('section6');if(!section)return;const originalCanvas=document.getElementById('fp-original');const dctCanvasLP=document.getElementById('fp-dct-lp');const dctCanvasHP=document.getElementById('fp-dct-hp');const processedCanvas=document.getElementById('fp-processed');const low=document.getElementById('fp-low');const high=document.getElementById('fp-high');const lowVal=document.getElementById('fp-low-val');const highVal=document.getElementById('fp-high-val');const statusEl=document.getElementById('fp-status');const resetBtn=document.getElementById('fp-reset');if(!originalCanvas||!dctCanvasLP||!dctCanvasHP||!processedCanvas||!low||!high)return;let size=128;const img=new Image();img.src='assets/lesson3/cat.jpg';img.crossOrigin='anonymous';const octx=originalCanvas.getContext('2d');const dlctx=dctCanvasLP.getContext('2d');const dhctx=dctCanvasHP.getContext('2d');const prctx=processedCanvas.getContext('2d');let basePixels;let cosTable;let alpha;let coeffs;let busy=false;function setStatus(lp=low.value,hp=high.value){statusEl.textContent=`LP ${lp}% • HP ${hp}% • Size: ${size}×${size}`}
function initTables(n){cosTable=new Array(n);for(let k=0;k<n;k++){cosTable[k]=new Float32Array(n);for(let n2=0;n2<n;n2++)cosTable[k][n2]=Math.cos(Math.PI*(n2+0.5)*k/n)}alpha=new Float32Array(n);for(let k=0;k<n;k++)alpha[k]=k===0?1/Math.sqrt(n):Math.sqrt(2/n)}
function toGrayscaleAndResizeFromSource(src,n){const tmp=document.createElement('canvas');const tctx=tmp.getContext('2d');const sw=src.width||src.naturalWidth;const sh=src.height||src.naturalHeight;const s=Math.min(sw,sh);tmp.width=n;tmp.height=n;tctx.drawImage(src,(sw-s)/2,(sh-s)/2,s,s,0,0,n,n);const d=tctx.getImageData(0,0,n,n).data;const g=new Float32Array(n*n);for(let i=0,j=0;i<d.length;i+=4,j++){g[j]=0.299*d[i]+0.587*d[i+1]+0.114*d[i+2]-128}return g}
function getJpegOrientation(buf){try{const view=new DataView(buf);if(view.getUint16(0,false)!==0xFFD8)return 1;let offset=2;while(offset<view.byteLength){const marker=view.getUint16(offset,false);offset+=2;if((marker&0xFF00)!==0xFF00)break;const size=view.getUint16(offset,false);if(marker===0xFFE1){const start=offset+2;if(view.getUint32(start,false)!==0x45786966)return 1;const tiff=start+6;const little=view.getUint16(tiff,false)===0x4949;const ifd= view.getUint32(tiff+4,little);let dir=tiff+ifd;const entries=view.getUint16(dir,little);for(let i=0;i<entries;i++){const entry=dir+2+i*12;const tag=view.getUint16(entry,little);if(tag===0x0112){return view.getUint16(entry+8,little)}}}offset+=size}return 1}catch(e){return 1}}
function dct2d(src,n){const tmp=new Float32Array(n*n);const dst=new Float32Array(n*n);for(let u=0;u<n;u++){for(let x=0;x<n;x++){let sum=0;for(let i=0;i<n;i++)sum+=src[i*n+x]*cosTable[u][i];tmp[u*n+x]=alpha[u]*sum}}for(let v=0;v<n;v++){for(let u=0;u<n;u++){let sum=0;for(let x=0;x<n;x++)sum+=tmp[u*n+x]*cosTable[v][x];dst[v*n+u]=alpha[v]*sum}}return dst}
function idct2d(src,n){const tmp=new Float32Array(n*n);const dst=new Float32Array(n*n);for(let x=0;x<n;x++){for(let v=0;v<n;v++){let sum=0;for(let u=0;u<n;u++)sum+=alpha[u]*src[v*n+u]*cosTable[u][x];tmp[v*n+x]=sum*alpha[v]}}for(let i=0;i<n;i++){for(let j=0;j<n;j++){let sum=0;for(let v=0;v<n;v++)sum+=alpha[v]*tmp[v*n+j]*cosTable[v][i];dst[i*n+j]=sum}}return dst}
function rotateCW(arr,n){const out=new Float32Array(n*n);for(let y=0;y<n;y++){for(let x=0;x<n;x++){out[y*n+x]=arr[(n-1-x)*n+y]}}return out}
function drawImageCanvas(pixels,n,ctx){const imgData=ctx.createImageData(n,n);for(let i=0,j=0;i<imgData.data.length;i+=4,j++){const vv=pixels[j]+128;const v=Math.max(0,Math.min(255,Math.round(vv)));imgData.data[i]=imgData.data[i+1]=imgData.data[i+2]=v;imgData.data[i+3]=255}ctx.putImageData(imgData,0,0)}
function drawDctHeatmap(coeff,n,ctx,maskR,mode){const mag=new Float32Array(n*n);let max=0;for(let i=0;i<coeff.length;i++){const m=Math.log1p(Math.abs(coeff[i]));mag[i]=m;if(m>max)max=m}const imgData=ctx.createImageData(n,n);const r2=maskR*maskR;for(let y=0;y<n;y++){for(let x=0;x<n;x++){const idx=y*n+x;const val=Math.floor((mag[idx]/max)*255)||0;const dx=x,dy=y;const inside=(dx*dx+dy*dy)<=r2;let shade=val;if(mode==='LP'&&!inside)shade=0;if(mode==='HP'&&inside)shade=0;const i4=idx*4;imgData.data[i4]=imgData.data[i4+1]=imgData.data[i4+2]=shade;imgData.data[i4+3]=255}}ctx.putImageData(imgData,0,0)}
function applyMasksAndRender(){if(busy)return;busy=true;requestAnimationFrame(()=>{const n=size;const lp=parseInt(low.value,10);const hp=parseInt(high.value,10);lowVal.textContent=`${lp}%`;highVal.textContent=`${hp}%`;setStatus(lp,hp);const maxR=Math.hypot(n-1,n-1);const rLP=(lp/100)*maxR;const rHP=(hp/100)*maxR;const r2LP=rLP*rLP;const r2HP=rHP*rHP;const combined=new Float32Array(coeffs.length);for(let y=0;y<n;y++){for(let x=0;x<n;x++){const idx=y*n+x;const d2=x*x+y*y;const keepLP=d2<=r2LP;const keepHP=d2>r2HP;combined[idx]=coeffs[idx]*((keepLP&&keepHP)?1:0)}}
drawDctHeatmap(coeffs,n,dlctx,rLP,'LP');drawDctHeatmap(coeffs,n,dhctx,rHP,'HP');const recon=idct2d(combined,n);const reconOriented=rotateCW(recon,n);drawImageCanvas(reconOriented,n,prctx);busy=false})}
function handleChange(){applyMasksAndRender()}function reset(){low.value=100;high.value=0;lowVal.textContent='100%';highVal.textContent='0%';setStatus();applyMasksAndRender()}
low.addEventListener('change',handleChange);high.addEventListener('change',handleChange);
img.onload=()=>{const maxDim=Math.max(img.width,img.height);size=maxDim>800?128:128;originalCanvas.width=originalCanvas.height=size;dctCanvasLP.width=dctCanvasLP.height=size;dctCanvasHP.width=dctCanvasHP.height=size;processedCanvas.width=processedCanvas.height=size;initTables(size);basePixels=toGrayscaleAndResizeFromSource(img,size);drawImageCanvas(basePixels,size,octx);coeffs=dct2d(basePixels,size);reset()};
low.addEventListener('input',handleChange);high.addEventListener('input',handleChange);resetBtn&&resetBtn.addEventListener('click',reset);
})();
// Section 4/5 static renders using the same DCT/IDCT core
(()=>{const lpDct=document.getElementById('lp-static-dct');const lpRes=document.getElementById('lp-static-result');const hpDct=document.getElementById('hp-static-dct');const hpRes=document.getElementById('hp-static-result');const lpOrig=document.getElementById('lp-static-original');const hpOrig=document.getElementById('hp-static-original');if(!lpDct&&!hpDct&&!lpOrig&&!hpOrig)return;const n=128;const img=new Image();img.src='assets/lesson3/cat.jpg';img.crossOrigin='anonymous';let ct2,al2;function prepare(){ct2=new Array(n);for(let k=0;k<n;k++){ct2[k]=new Float32Array(n);for(let i=0;i<n;i++)ct2[k][i]=Math.cos(Math.PI*(i+0.5)*k/n)}al2=new Float32Array(n);for(let k=0;k<n;k++)al2[k]=k===0?1/Math.sqrt(n):Math.sqrt(2/n)}
function toGray(src){const tmp=document.createElement('canvas');const t=tmp.getContext('2d');tmp.width=n;tmp.height=n;const sw=src.width||src.naturalWidth,sh=src.height||src.naturalHeight;const s=Math.min(sw,sh);t.drawImage(src,(sw-s)/2,(sh-s)/2,s,s,0,0,n,n);const d=t.getImageData(0,0,n,n).data;const g=new Float32Array(n*n);for(let i=0,j=0;i<d.length;i+=4,j++){g[j]=0.299*d[i]+0.587*d[i+1]+0.114*d[i+2]-128}return g}
function dct2(src){const tmp=new Float32Array(n*n),dst=new Float32Array(n*n);for(let u=0;u<n;u++){for(let x=0;x<n;x++){let s=0;for(let i=0;i<n;i++)s+=src[i*n+x]*ct2[u][i];tmp[u*n+x]=al2[u]*s}}for(let v=0;v<n;v++){for(let u=0;u<n;u++){let s=0;for(let x=0;x<n;x++)s+=tmp[u*n+x]*ct2[v][x];dst[v*n+u]=al2[v]*s}}return dst}
function idct2(src){const tmp=new Float32Array(n*n),dst=new Float32Array(n*n);for(let x=0;x<n;x++){for(let v=0;v<n;v++){let s=0;for(let u=0;u<n;u++)s+=al2[u]*src[v*n+u]*ct2[u][x];tmp[v*n+x]=s*al2[v]}}for(let i=0;i<n;i++){for(let j=0;j<n;j++){let s=0;for(let v=0;v<n;v++)s+=al2[v]*tmp[v*n+j]*ct2[v][i];dst[i*n+j]=s}}return dst}
function rotateCW(arr){const out=new Float32Array(n*n);for(let y=0;y<n;y++){for(let x=0;x<n;x++){out[y*n+x]=arr[(n-1-x)*n+y]}}return out}
function drawImg(p,ctx){const id=ctx.createImageData(n,n);for(let i=0,j=0;i<id.data.length;i+=4,j++){const v=Math.max(0,Math.min(255,Math.round(p[j]+128)));id.data[i]=id.data[i+1]=id.data[i+2]=v;id.data[i+3]=255}ctx.putImageData(id,0,0)}
function drawHeat(coeff,ctx){let max=0;const mag=new Float32Array(n*n);for(let i=0;i<coeff.length;i++){const m=Math.log1p(Math.abs(coeff[i]));mag[i]=m;if(m>max)max=m}const id=ctx.createImageData(n,n);for(let y=0;y<n;y++){for(let x=0;x<n;x++){const idx=y*n+x;const shade=Math.floor((mag[idx]/max)*255)||0;const k=idx*4;id.data[k]=id.data[k+1]=id.data[k+2]=shade;id.data[k+3]=255}}ctx.putImageData(id,0,0)}
function renderLP(px){const C=dct2(px);if(lpDct){const ctx=lpDct.getContext('2d');drawHeat(C,ctx);/* conceptual mask: blackout top-left corner */const id=ctx.getImageData(0,0,n,n);const r2=Math.pow(Math.hypot(n-1,n-1)*0.6,2);for(let y=0;y<n;y++)for(let x=0;x<n;x++){if(x*x+y*y>r2){const k=(y*n+x)*4;id.data[k]=id.data[k+1]=id.data[k+2]=0}}ctx.putImageData(id,0,0)}const r2lp=Math.pow(Math.hypot(n-1,n-1)*0.6,2);for(let y=0;y<n;y++)for(let x=0;x<n;x++){const i=y*n+x;if(x*x+y*y>r2lp)C[i]=0}const recon=idct2(C);const oriented=rotateCW(recon);if(lpRes)drawImg(oriented,lpRes.getContext('2d'))}
function renderHP(px){const C=dct2(px);if(hpDct){const ctx=hpDct.getContext('2d');drawHeat(C,ctx);/* add faint speckle to highs */const id=ctx.getImageData(0,0,n,n);for(let y=0;y<n;y++)for(let x=0;x<n;x++){const d2=x*x+y*y;const r2=Math.pow(Math.hypot(n-1,n-1)*0.2,2);if(d2>r2 && Math.random()<0.03){const k=(y*n+x)*4;const v=id.data[k];const add=Math.floor(0.15*v);id.data[k]=id.data[k+1]=id.data[k+2]=Math.min(255,v+add)}}ctx.putImageData(id,0,0)}const r2=Math.pow(Math.hypot(n-1,n-1)*0.2,2);for(let y=0;y<n;y++)for(let x=0;x<n;x++){const i=y*n+x;if(x*x+y*y<=r2)C[i]=0}const recon=idct2(C);const oriented=rotateCW(recon);if(hpRes)drawImg(oriented,hpRes.getContext('2d'))}
img.onload=()=>{prepare();const px=toGray(img);if(lpOrig)drawImg(px,lpOrig.getContext('2d'));if(hpOrig)drawImg(px,hpOrig.getContext('2d'));if(lpDct||lpRes)renderLP(px);if(hpDct||hpRes)renderHP(px)};
})();
function toggleCompleted(){const btn=document.getElementById('markCompletedBtn');if(!btn)return;const done=btn.classList.contains('completed');if(done)return;try{if(window.parent&&window.parent.ProgressTracker){let courseId='computer-vision';let pathId='fourier-transform-and-images';let moduleId='cv-dct-filtering';let lessonId='cv-l3-hacking-frequencies';if(window.parent.currentRoute){const r=window.parent.currentRoute;if(r.courseId)courseId=r.courseId;if(r.pathId)pathId=r.pathId;if(r.moduleId)moduleId=r.moduleId;if(r.lessonId)lessonId=r.lessonId}const urlParams=new URLSearchParams(window.location.search);if(urlParams.get('course'))courseId=urlParams.get('course');if(urlParams.get('path'))pathId=urlParams.get('path');if(urlParams.get('module'))moduleId=urlParams.get('module');if(urlParams.get('lesson'))lessonId=urlParams.get('lesson');window.parent.ProgressTracker.markLessonCompleted(courseId,pathId,moduleId,lessonId)}}catch(err){console.error('Error with ProgressTracker:',err)}btn.classList.add('completed');btn.innerHTML='✅ Completed!';localStorage.setItem('lesson_cv-ch06-l3_completed','true');const msg=document.createElement('div');msg.className='lesson-success-message';msg.textContent='🎉 Lesson Completed! Great Job! 🎉';document.querySelector('.lesson-container').appendChild(msg);requestAnimationFrame(()=>msg.classList.add('show'))}
window.addEventListener('load',function(){const btn=document.getElementById('markCompletedBtn');if(!btn)return;try{if(window.parent&&window.parent.ProgressTracker){let courseId='computer-vision';let pathId='fourier-transform-and-images';let moduleId='cv-dct-filtering';let lessonId='cv-l3-hacking-frequencies';if(window.parent.currentRoute){const r=window.parent.currentRoute;if(r.courseId)courseId=r.courseId;if(r.pathId)pathId=r.pathId;if(r.moduleId)moduleId=r.moduleId;if(r.lessonId)lessonId=r.lessonId}const urlParams=new URLSearchParams(window.location.search);if(urlParams.get('course'))courseId=urlParams.get('course');if(urlParams.get('path'))pathId=urlParams.get('path');if(urlParams.get('module'))moduleId=urlParams.get('module');if(urlParams.get('lesson'))lessonId=urlParams.get('lesson');const progress=window.parent.ProgressTracker.getLessonProgress(courseId,pathId,moduleId,lessonId);if(progress.state===window.parent.ProgressTracker.STATES.COMPLETED){btn.classList.add('completed');btn.innerHTML='✅ Completed!';return}}}catch(e){}const isCompleted=localStorage.getItem('lesson_cv-ch06-l3_completed')==='true';if(isCompleted){btn.classList.add('completed');btn.innerHTML='✅ Completed!'}});
document.documentElement.style.scrollBehavior='smooth';
</script>
</body>
</html>